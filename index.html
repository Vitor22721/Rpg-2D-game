<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ”¥ RPG Game ğŸ”¥</title>
  <style>
    body { background: #444; color: white; font-family: sans-serif; text-align: center; }
    canvas { background: #222; border: 2px solid #fff; display: block; margin: 10px auto; }
    button { padding: 6px 12px; margin: 5px; font-weight: bold; }
    #hud, #acoes, #inventario, #loja, #log { margin-top: 10px; }
    #log div { font-size: 12px; margin: 2px; padding: 4px; background: #333; border-radius: 4px; }
    .destaque { color: #ffcc00; font-weight: bold; }
  </style>
</head>
<body>
  <h1>ğŸ”¥ RPG Game ğŸ”¥</h1>
  <canvas id="game" width="640" height="360"></canvas>

  <div id="hud">
    â¤ï¸ Vida: <span id="vida">100%</span> |
    ğŸ”® Mana: <span id="mana">50</span> |
    ğŸ›¡ï¸ Defesa: <span id="defesa">5</span> |
    â­ NÃ­vel: <span id="nivel">1</span> |
    ğŸ“˜ XP: <span id="xp">0</span> |
    ğŸ’° Moedas: <span id="moedas">20</span>
  </div>

  <div id="inventario">
    ğŸ’ InventÃ¡rio:
    <span id="pocoes">3 poÃ§Ãµes</span> |
    <span id="espada">Espada: âŒ</span> |
    <span id="armadura">Armadura: âŒ</span> |
    <span id="itemUnico">Item Ãšnico: âŒ</span>
  </div>

  <div id="acoes">
    <button onclick="acao('atacar')">âš”ï¸ Atacar</button>
    <button onclick="acao('magia')">âœ¨ Magia</button>
    <button onclick="acao('usarPocao')">ğŸ§ª PoÃ§Ã£o</button>
    <button onclick="abrirLoja()">ğŸ›’ Loja</button>
  </div>

  <div id="loja" style="display:none;">
    <h3>ğŸ›ï¸ Loja</h3>
    <button onclick="comprar('pocao')">ğŸ§ª PoÃ§Ã£o (5 ğŸ’°)</button>
    <button onclick="comprar('espada')">ğŸ—¡ï¸ Espada (15 ğŸ’°)</button>
    <button onclick="comprar('armadura')">ğŸ›¡ï¸ Armadura (15 ğŸ’°)</button>
    <button onclick="fecharLoja()">âŒ Fechar</button>
  </div>

  <div id="log"></div>

  <script>
    // ğŸ§™â€â™‚ï¸ CRIAÃ‡ÃƒO DE PERSONAGEM
    function criarPersonagem() {
      let nome = prompt("Digite o nome do seu personagem:");
      while (!nome || nome.trim() === "") nome = prompt("Nome invÃ¡lido! Digite o nome do seu personagem:");

      let raca;
      while (true) {
        const r = prompt("Escolha sua raÃ§a:\n1. AnÃ£o\n2. Elfo\n3. Humano");
        if (r === "1") { raca = "AnÃ£o"; break; }
        if (r === "2") { raca = "Elfo"; break; }
        if (r === "3") { raca = "Humano"; break; }
        alert("OpÃ§Ã£o invÃ¡lida!");
      }

      let classe;
      while (true) {
        const c = prompt("Escolha sua classe:\n1. Guerreiro\n2. Mago\n3. Arqueiro");
        if (c === "1") { classe = "Guerreiro"; break; }
        if (c === "2") { classe = "Mago"; break; }
        if (c === "3") { classe = "Arqueiro"; break; }
        alert("OpÃ§Ã£o invÃ¡lida!");
      }

      let atributos = { forca: 5, magia: 5, agilidade: 5, vida: 50 };
      if (raca === "AnÃ£o") { atributos.forca += 2; atributos.vida += 10; }
      if (raca === "Elfo") { atributos.agilidade += 2; atributos.magia += 1; }
      if (classe === "Guerreiro") atributos.forca += 3;
      if (classe === "Mago") atributos.magia += 3;
      if (classe === "Arqueiro") atributos.agilidade += 3;

      alert(`--- Ficha ---\nNome: ${nome}\nRaÃ§a: ${raca}\nClasse: ${classe}\nForÃ§a: ${atributos.forca}\nMagia: ${atributos.magia}\nAgilidade: ${atributos.agilidade}\nVida Base: ${atributos.vida}`);

      return { nome, raca, classe, atributos };
    }

    const personagem = criarPersonagem();

    // ğŸ§¾ JOGADOR
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    const jogador = {
      ...personagem,
      vidaMax: 0, vida: 0,
      manaMax: 0, mana: 0,
      nivel: 1, xp: 0, moedas: 20,
      dano: 0, defesa: 0,
      pocoes: 3,
      espada: false,
      armadura: false,
      itemUnico: false
    };

    // Inicializar stats
    jogador.vidaMax = personagem.atributos.vida * 2;
    jogador.vida = jogador.vidaMax;
    jogador.manaMax = 20 + personagem.atributos.magia * 4;
    jogador.mana = jogador.manaMax;
    jogador.dano = Math.floor(personagem.atributos.forca * 2.5);
    jogador.defesa = Math.floor(personagem.atributos.forca / 2) + 2;

    let inimigo = gerarInimigo();
    let gameOver = false;

    // âš”ï¸ FUNÃ‡Ã•ES DO JOGO
    function gerarInimigo() {
      const nomesNormais = ["Goblin", "Orc", "Esqueleto", "Lobo Selvagem", "Bandido", "Troll", "Aranha Gigante"];
      const ehBoss = (jogador.nivel % 5 === 0 && jogador.nivel >= 5);

      if (ehBoss) {
        return {
          nome: "ğŸ”¥ BOSS: " + ["DragÃ£o das Sombras", "Senhor dos Mortos", "Rei DemÃ´nio", "Colosso de Ferro"][Math.floor(Math.random()*4)],
          vida: (40 + jogador.nivel * 20) * 2.5,
          ataque: 10 + jogador.nivel * 4
        };
      }

      const nome = nomesNormais[Math.floor(Math.random() * nomesNormais.length)];
      const vida = 40 + jogador.nivel * 12;
      const ataque = 7 + jogador.nivel * 2;
      return { nome, vida, ataque };
    }

    function log(texto) {
      const div = document.getElementById("log");
      const linha = document.createElement("div");
      linha.innerHTML = texto;
      div.prepend(linha);
      if (div.children.length > 15) div.removeChild(div.lastChild);
      div.scrollTop = 0;
    }

    function desenhar() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Jogador
      ctx.fillStyle = "#0f0";
      ctx.beginPath();
      ctx.arc(120, 180, 28, 0, Math.PI * 2);
      ctx.fill();

      ctx.fillStyle = "white";
      ctx.font = "14px sans-serif";
      ctx.fillText(jogador.nome.substring(0,10), 85, 165);
      ctx.fillText(Math.round((jogador.vida / jogador.vidaMax)*100) + "%", 95, 205);

      // Inimigo
      const ehBoss = inimigo.nome.includes("BOSS");
      ctx.fillStyle = ehBoss ? "#ff4444" : "red";
      ctx.fillRect(460, 140, 70, 70);

      ctx.fillStyle = "white";
      ctx.font = ehBoss ? "18px sans-serif" : "16px sans-serif";
      ctx.fillText(inimigo.nome, 420, 130);
      ctx.fillText(`HP: ${Math.round(inimigo.vida)}`, 420, 155);

      requestAnimationFrame(desenhar);
    }

    function atualizarHUD() {
      document.getElementById("vida").textContent = Math.round((jogador.vida / jogador.vidaMax) * 100) + "%";
      document.getElementById("mana").textContent = Math.round(jogador.mana);
      document.getElementById("defesa").textContent = jogador.defesa;
      document.getElementById("nivel").textContent = jogador.nivel;
      document.getElementById("xp").textContent = jogador.xp;
      document.getElementById("moedas").textContent = jogador.moedas;
      document.getElementById("pocoes").textContent = jogador.pocoes + " poÃ§Ãµes";
      document.getElementById("espada").textContent = "Espada: " + (jogador.espada ? "âœ…" : "âŒ");
      document.getElementById("armadura").textContent = "Armadura: " + (jogador.armadura ? "âœ…" : "âŒ");
      document.getElementById("itemUnico").textContent = "Item Ãšnico: " + (jogador.itemUnico ? "âœ…" : "âŒ");
    }

    function acao(tipo) {
      if (gameOver) return;

      let turnoInimigo = true;

      if (tipo === "atacar") {
        const dano = jogador.dano + (jogador.espada ? 10 : 0);
        inimigo.vida -= dano;
        log(`âš”ï¸ <span class="destaque">\( {jogador.nome}</span> causou <b> \){dano}</b> de dano!`);
      }
      else if (tipo === "magia") {
        if (jogador.mana < 18) {
          log("ğŸ”® Mana insuficiente! (precisa de 18)");
          turnoInimigo = false;
        } else {
          jogador.mana -= 18;
          const danoMagia = 22 + personagem.atributos.magia * 3;
          inimigo.vida -= danoMagia;
          log(`âœ¨ <span class="destaque">${jogador.nome}</span> lanÃ§ou <b>Magia Arcana</b>! ${danoMagia} dano!`);
        }
      }
      else if (tipo === "usarPocao" && jogador.pocoes > 0) {
        const cura = Math.min(45, jogador.vidaMax - jogador.vida);
        jogador.vida += cura;
        jogador.pocoes--;
        log(`ğŸ§ª <b>+${cura} vida</b> restaurada!`);
      }
      else {
        log("âŒ AÃ§Ã£o invÃ¡lida!");
        return;
      }

      atualizarHUD();

      if (inimigo.vida <= 0) {
        vitoria();
        turnoInimigo = false;
      }

      if (turnoInimigo) {
        setTimeout(ataqueInimigo, 700);
      }
    }

    function ataqueInimigo() {
      const danoInimigo = Math.max(1, inimigo.ataque - jogador.defesa - (jogador.armadura ? 8 : 0));
      jogador.vida -= danoInimigo;
      log(`ğŸ’¥ <span class="destaque">\( {inimigo.nome}</span> causou <b> \){danoInimigo}</b> de dano!`);
      atualizarHUD();
      if (jogador.vida <= 0) morte();
    }

    function vitoria() {
      log(`ğŸ‰ <b>${inimigo.nome} derrotado!</b>`);
      const xpGanho = 20 + Math.floor(Math.random() * 15) + (jogador.nivel * 3);
      const moedasGanhas = 6 + Math.floor(Math.random() * 8);
      jogador.xp += xpGanho;
      jogador.moedas += moedasGanhas;
      log(`+\( {xpGanho} XP  |  + \){moedasGanhas} moedas`);

      const xpNecessario = 30 * jogador.nivel;
      if (jogador.xp >= xpNecessario) {
        jogador.nivel++;
        jogador.xp -= xpNecessario;

        jogador.vidaMax += 30;
        jogador.manaMax += 18;
        jogador.vida = jogador.vidaMax;
        jogador.mana = jogador.manaMax;

        log(`<span style="color:lime;font-weight:bold">â˜…â˜…â˜… NÃ­vel ${jogador.nivel} alcanÃ§ado! â˜…â˜…â˜…</span>`);

        // Escolha de perk
        let perkEscolhido = prompt(
          "Escolha uma melhoria para o nÃ­vel " + jogador.nivel + ":\n\n" +
          "1 - +8 de Dano permanente\n" +
          "2 - +6 de Defesa permanente\n" +
          "3 - +60 Vida MÃ¡xima e cura total\n" +
          "4 - +25 Mana MÃ¡xima e +10 dano mÃ¡gico"
        );

        if (perkEscolhido === "1") {
          jogador.dano += 8;
          log("Escolhido: +8 DANO");
        } else if (perkEscolhido === "2") {
          jogador.defesa += 6;
          log("Escolhido: +6 DEFESA");
        } else if (perkEscolhido === "3") {
          jogador.vidaMax += 60;
          jogador.vida = jogador.vidaMax;
          log("Escolhido: +60 VIDA MÃXIMA");
        } else if (perkEscolhido === "4") {
          jogador.manaMax += 25;
          personagem.atributos.magia += 2; // aumenta dano mÃ¡gico futuro
          jogador.mana = jogador.manaMax;
          log("Escolhido: +25 MANA e +10 dano mÃ¡gico base");
        } else {
          log("Nenhum perk escolhido â†’ bÃ´nus padrÃ£o (+3 dano, +2 defesa)");
          jogador.dano += 3;
          jogador.defesa += 2;
        }

        atualizarHUD();
      }

      inimigo = gerarInimigo();
    }

    function morte() {
      gameOver = true;
      log(`ğŸ’€ <b>${jogador.nome} foi derrotado!</b> GAME OVER`);
      log("Pressione F5 para jogar novamente");
      document.querySelectorAll("button").forEach(b => b.disabled = true);
    }

    function abrirLoja() { 
      document.getElementById("loja").style.display = "block"; 
      document.getElementById("acoes").style.display = "none"; 
    }
    function fecharLoja() { 
      document.getElementById("loja").style.display = "none"; 
      document.getElementById("acoes").style.display = "block"; 
    }

    function comprar(item) {
      if (item === "pocao" && jogador.moedas >= 5) {
        jogador.moedas -= 5;
        jogador.pocoes++;
        log("ğŸ§ª PoÃ§Ã£o comprada!");
      } else if (item === "espada" && !jogador.espada && jogador.moedas >= 15) {
        jogador.moedas -= 15;
        jogador.espada = true;
        log("ğŸ—¡ï¸ Espada comprada! +10 dano");
      } else if (item === "armadura" && !jogador.armadura && jogador.moedas >= 15) {
        jogador.moedas -= 15;
        jogador.armadura = true;
        jogador.defesa += 10;
        log("ğŸ›¡ï¸ Armadura comprada! +10 defesa");
      } else {
        log("ğŸ’¸ Moedas insuficientes ou item jÃ¡ possuÃ­do!");
      }
      atualizarHUD();
    }

    // Iniciar
    atualizarHUD();
    desenhar();
    log("ğŸ® Jogo iniciado! Boa sorte, aventureiro!");
  </script>
</body>
</html>